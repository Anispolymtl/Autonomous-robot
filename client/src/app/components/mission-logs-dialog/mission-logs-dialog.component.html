<div class="logs-dialog">
    <header class="dialog-header">
        <div>
            <p class="eyebrow">Mission</p>
            <h2>{{ data.mission.missionName }}</h2>
            <p class="meta">
                Robots {{ data.mission.robots.length ? (data.mission.robots.join(' & ')) : 'N/A' }} • Mode {{ data.mission.mode }} •
                {{ data.mission.createdAt ? (data.mission.createdAt | date : 'medium') : 'Date inconnue' }}
            </p>
        </div>
        <button type="button" class="close-btn" (click)="close()">✕</button>
    </header>

    <section class="mission-summary">
        <div class="summary-card">
            <span class="label">Distance</span>
            <span class="value">
                {{ data.mission.distance >= 1000 ? (data.mission.distance / 1000 | number : '1.0-2') + ' km' : data.mission.distance + ' m' }}
            </span>
        </div>
        <div class="summary-card">
            <span class="label">Durée</span>
            <span class="value">{{ (data.mission.durationSec / 60) | number:'1.0-1' }} min</span>
        </div>
        <div class="summary-card">
            <span class="label">Mode</span>
            <span class="value">{{ data.mission.mode }}</span>
        </div>
    </section>

    <section class="logs-section">
        <div class="logs-header">
            <h3>Logs ({{ data.logs?.length || 0 }})</h3>
        </div>

        <div *ngIf="!data.logs || data.logs.length === 0" class="empty-state">
            Aucun log disponible pour cette mission.
        </div>

        <ng-container *ngFor="let log of data.logs ?? []">
            <div class="log-entry">
                <div class="log-meta">
                    <div>
                        <span class="meta-label">Heure</span>
                        <span class="meta-value">{{ formatTimestamp(log.timestamp) }}</span>
                    </div>
                    <div>
                        <span class="meta-label">Robot</span>
                        <span class="meta-value">{{ log.robot }}</span>
                    </div>
                    <div>
                        <span class="meta-label">Catégorie</span>
                        <span class="meta-value">{{ log.category }}</span>
                    </div>
                    <div>
                        <span class="meta-label">Action</span>
                        <span class="meta-value">{{ log.action }}</span>
                    </div>
                </div>

                <div class="log-details" *ngIf="getDetailEntries(log) as details" [class.empty]="details.length === 0">
                    <span *ngIf="details.length === 0" class="detail-placeholder">Aucun détail</span>
                    <div class="detail-chip" *ngFor="let detail of details">
                        <span class="detail-key">{{ detail.key }}</span>
                        <span class="detail-value">{{ formatValue(detail.value) }}</span>
                    </div>
                </div>
            </div>
        </ng-container>
    </section>
</div>
